<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="css/main.css">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
crossorigin="anonymous"></script>
<script type='text/javascript' src='js/constants.js'></script>
<script type='text/javascript' src='js/res_EN.js'></script>
<script type='text/javascript' src='js/gen_html.js'></script>
<script type='text/javascript' src='js/check.js'></script>
<script type='text/javascript'>
$(document).ready(function() {
	toggleAll();
	
	toggleHeroRelated(ch_str.SALTZ);
	toggleHeroRelated(ch_str.KRUBER);
	toggleHeroRelated(ch_str.BARDIN);
	toggleHeroRelated(ch_str.SIENNA);
	toggleHeroRelated(ch_str.KERI);
	
	toggleDLC(options_str.DLC_BTU, dlc_btu_wpn);
	toggleDLC(options_str.DLC_WOM, dlc_wom_wpn);
	toggleDLC(options_str.DLC_GK, dlc_gk_wpn, dlc_gk_cls);
	toggleDLC(options_str.DLC_OE, dlc_oe_wpn, dlc_oe_cls);
	
	$('#drawBtn').click(function() {
		document.getElementById('output').innerHTML = drawLoadout();
	});
});

//TODO: keep and eye on it...
async function ajax() {
	$('#lastUpdate')[0].innerHTML = await getLastUpdateDate();
};

function init() {	
	ajax();

	document.getElementsByClassName('col-options')[0].innerHTML = createSection('', 'options', options_str, res_options, 'options');
	document.getElementsByClassName('col-chars')[0].innerHTML = createSection('CHARACTERS', 'chars', ch_str, res_chars, 'chars');
	document.getElementsByClassName('col-cls')[0].innerHTML = createSection('CLASSES', 'cls', cls_str, res_cls, 'classes');
	document.getElementsByClassName('col-wpnm')[0].innerHTML = createSection('MELEE', 'wpnm', wpnm_str, res_wpnm, 'melee');
	document.getElementsByClassName('col-wpnr')[0].innerHTML = createSection('RANGED', 'wpnr', wpnr_str, res_wpnr, 'ranged');
	
	//set all heroes by default
	var defaultAll = $('#select-all')[0];
	defaultAll.checked = true;
	setAll(cat_str, defaultAll.checked);
	
	//read from local storage
	loadDLCStore(options_str.DLC_BTU, dlc_btu_wpn);
	loadDLCStore(options_str.DLC_WOM, dlc_wom_wpn);
	loadDLCStore(options_str.DLC_GK, dlc_gk_wpn, dlc_gk_cls);
	loadDLCStore(options_str.DLC_OE, dlc_oe_wpn, dlc_oe_cls);
}
</script>
</head>
<body onload="init()" class="pb-5">
	<div class="container">
		<div class="row">
			<div class="col-options col-12"></div>
		</div>
		<div class="row mt-3">
			<div class="col-12 text-center">Select desired characters and rest of the pool you wish to draw from!</div>
		</div>
		<div class="row mt-3" style="border: 2px dotted gray;">
			<div id="output" class="col-12 d-inline text-center align-middle font-weight-bold p-2">&nbsp;</div>
		</div>
		<div class="row mt-3">
			<p id="drawBtn" class="col-12 text-center"><button>DRAW</button></p>
		</div>
			
		<div class="row">
			<div class="col-chars col-sm-3"></div>
			<div class="col-cls col-sm-3"></div>
			<div class="col-wpnm col-sm-3"></div>
			<div class="col-wpnr col-sm-3"></div>
		</div>
	</div>
	<footer class="fixed-bottom">
		<div class="container">
			<div class="row p-1 small">
				<div class="col-12">
					<span id="lastUpdate"></span>
					<span class="float-right">Created by <a href="https://steamcommunity.com/id/bluehardt">Blue</a></span>
				</div>
			</div>
		</div>
	</footer>
</body>
</html>
